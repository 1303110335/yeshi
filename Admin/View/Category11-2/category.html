<include file="Public:head"/>

<div class="container">
    <div class="inner clearfix">
        <div class="content-left fl">

            <dl class="left-menu shop_2 sub_commodity">
                <dt>
                    <i class="icon-menu commodity"></i>
                    <span id="shop_2" data-id="2">商品管理</span>
                </dt>
                <dd class="subshop_0 ">
                    <a href="{:U('/Admin/Goods/add')}">发布商品</a>
                </dd>
                <dd class="subshop_6">
                    <a href="{:U('/Admin/Goods/index')}">出售中的商品</a>
                </dd>
                <!--<dd class="subshop_7 ">-->
                    <!--<a href="{:U('/Admin/Goods/onsku')}">仓库中的商品</a>-->
                    <!--<i class="icon_hot"></i></dd>-->
                <!--<dd class="subshop_8 ">-->
                    <!--<a href="{:U('/Admin/Goods/outstock')}">已售罄的商品</a>-->
                <!--</dd>-->
                <!--<dd class="subshop_9 ">-->
                    <!--<a href="{:U('/Admin/Goods/warn')}">警戒的商品</a>-->
                <!--</dd>-->
                <!--<dd class="subshop_12 ">-->
                <!--                    <a href="/Item/category_list">自定义类目</a>-->
                <!--</dd>-->
            </dl>
            <dl class="left-menu shop_3 sub_tags">
                <dt>
                    <i class="icon-menu tags"></i>
                    <span id="shop_3" data-id="3">分组管理</span>
                </dt>
                <dd class="subshop_0 active">

                    <a href="{:U('/Admin/Category/category')}">商品分类</a>
                </dd>        </dl>

        </div>
        <!-- end content-left -->

        <div class="content-right fl">


            <h1 class="content-right-title">商品分类列表</h1>


            <div class="alert alert-info disable-del"><h4>提示</h4>
                删除分类会删除分类下面所有的产品
                <a href="javascript:;" class="alert-delete" title="隐藏">
                    <i class="gicon-remove"></i></a></div>
            <form action="" method="post">


                <div class="clearfix">
                    <a href="javascript:;" class="btn btn-success fl BtnAddClass">添加分类</a>

                    <div class="tables-searchbox fr">
                        <input type="text" placeholder="分类名称" class="input" name="class_name" value="">
                        <button class="btn"><i class="gicon-search"></i>查询</button>
                    </div>
                </div>
            </form>

            <table class="wxtables mgt15">
                <colgroup>
                    <col width="2%">
                    <col width="20%">
                    <col width="10%">
                    <col width="15%">
                    <col width="20%">
                    <col width="38%">
                </colgroup>
                <thead>
                <tr>
                    <td><i class="icon_check"></i></td>
                    <td>分类名称</td>
                    <!--<td style="text-align:center">显隐操作</td>-->
                    <td>排序</td>
                    <td >创建时间</td>
                    <td class="center">操作</td>
                </tr>
                </thead>
                <tbody>
                <foreach name="category" item="vo" >

                <tr>
                    <td class="center">
                        <input type="checkbox" class="checkbox table-ckbs" data-id="9788">
                    </td>
                    <td>{$vo.classname}</td>
                    <!--<td>-->
                    <!--</td>-->
                    <td>{$vo.sortrank}</td>
                    <td>{$vo.addtime}</td>
                    <td class="center">
                        <a href="javascript:void(0);" class="btn btn-primary j-editClass" title="编辑" data-id="{$vo.id}"
                           data-title="{$vo.classname}" data-renk="{$vo.sortrank}">编辑</a>
                        <a href="{:U('/Admin/Category/delcategory/cid')}/{$vo.id}" class="btn btn-warning j-delClass" title="删除" onclick="return confirm('确定要删除吗？')" data-id="{$vo.id}">删除</a>
                        <!-- <a href="javascript:;" class="btn btn-warning j-able" data-able="enable" title="禁用" data-id="9788">禁用</a>
                          -->

                    </td>
                </tr>
                </foreach>
                </tbody>
            </table>
            <!-- end wxtables -->
            <div class="tables-btmctrl clearfix">
                <div class="fl">
                    <a href="javascript:;" class="btn btn-primary btn_table_selectAll">全选</a>
                    <a href="javascript:;" class="btn btn-primary btn_table_Cancle">取消</a>
                    <!--<a href="javascript;" class="btn btn-primary btn_table_delAll">批量删除</a></div>-->
                <div class="fr">
                    <!--<div class="paginate">-->

                        <div class="pages">
                            {$page}
                        <!--</div>-->
                    </div>
                    <!-- end paginate -->
                </div>
            </div>
            <!-- end tables-btmctrl -->
        </div>
        <!-- end content-right -->
    </div>
</div>
<!-- end container -->
<include file="Public:foot"/>

<div id="albums-overlay" class="disshow"></div>
<div class="jbox addfenlei disshow">
    <div class="jbox-title">
        <div class="jbox-title-txt">添加分类</div>
        <a href="javascript:;" class="jbox-close cancle"></a></div>
    <div class="jbox-container" style="height: 263px;">
        <div class="formitems">
            <label class="fi-name"><span class="colorRed">*</span>分类名称：</label>

            <div class="form-controls">
                <input type="text" class="input classname" name="classname" >
                <span class="fi-help-text"></span>
            </div>
        </div>

        <div class="formitems">
            <label class="fi-name"><span class="colorRed"></span>分类排序：</label>

            <div class="form-controls">
                <input type="text" class="input sort" name="serial" >
                <span class="fi-help-text"></span>
            </div>
        </div>

    </div>
    <div class="jbox-buttons"><a href="javascript:void(0);" class="jbox-buttons-ok btn btn-primary" id="addcategory">确定</a><a
            href="javascript:void (0);" class="jbox-buttons-ok btn cancle">取消</a></div>
</div>
<div class="jbox editfenlei disshow">
    <div class="jbox-title">
        <div class="jbox-title-txt">修改分类</div>
        <a href="javascript:;" class="jbox-close cancle"></a></div>
    <div class="jbox-container" style="height: 263px;">
        <div class="formitems">
            <label class="fi-name"><span class="colorRed">*</span>分类名称：</label>

            <div class="form-controls">
                <input type="text" class="input classname" name="classname" id="editclassname">
                <span class="fi-help-text"></span>
            </div>
        </div>

        <div class="formitems">
            <label class="fi-name"><span class="colorRed"></span>分类排序：</label>

            <div class="form-controls">
                <input type="text" class="input sort" name="serial" id="editsort" >
                <input type="hidden" class="input sort" name="serial" id="categoryid" >
                <span class="fi-help-text"></span>
            </div>
        </div>

    </div>
    <div class="jbox-buttons"><a href="javascript:void(0);" class="jbox-buttons-ok btn btn-primary" id="editcategory">确定</a><a
            href="javascript:;" class="jbox-buttons-ok btn cancle">取消</a></div>
</div>

<script type="text/javascript">
    $(".cancle").click(function(){
        $(this).parent().parent('.jbox').hide();
        $('#albums-overlay').hide();
    })
</script>
<script>

</script>

<!--添加分类-->

<script type="text/javascript">
    $(".BtnAddClass").click(function(){
        $('.addfenlei').show();
        $('#albums-overlay').show();
    })
</script>
<script type="text/javascript">
    $("#addcategory").click(function(){
        var classname = $('.classname').val();  //分类名称
        var sort = $('.sort').val();           //排序


        if (classname == '') {
            alert("分类名称必填！");
            return false;
        }
        $.ajax({
            url: "{:U('/Admin/Category/addCategory')}",
            type: "post",
            dataType: "json",
            data: {
                classname: classname,
                sort: sort
            }
        }).done(function (g) {
            if (g.status == 1) {
//                alert(g.info);
                window.location.href = "{:U('/Admin/Category/category')}";
            } else {
                alert(g.info);
            }

        })
    })
</script>
<!--添加分类end-->


<!--修改分类-->
<script type="text/javascript">
    var categoryid;
    $(".j-editClass").click(function(){
        $('.editfenlei').show();
        $('#albums-overlay').show();
        var categoryname=$(this).attr('data-title');
       categoryid=$(this).attr('data-id');
        var sort=$(this).attr('data-renk');
//        alert(categoryid);
        $('#editclassname').val(categoryname);
        $('#editsort').val(sort);
        $('#categoryid').val(categoryid);


    })


    $("#editcategory").click(function(){
        var classname = $('#editclassname').val();  //分类名称
        var sort = $('#editsort').val();           //排序
        var categoryid = $('#categoryid').val();           //排序

//alert(categoryid);
        if (classname == '') {
            alert("分类名称必填！");
            return false;
        }
        $.ajax({
            url: "{:U('/Admin/Category/editCategory')}",
            type: "post",
            dataType: "json",
            data: {
                classname: classname,
                sort: sort,
                categoryid:categoryid
            }
        }).done(function (g) {
            if (g.status == 1) {
//                alert(g.info);
                window.location.href = "{:U('/Admin/Category/category')}";
            } else {
                alert(g.info);
            }

        })
    })
</script>
<!--修改分类end-->